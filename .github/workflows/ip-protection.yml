# .github/workflows/ip-protection-minimal.yml
name: 🛡️ IP Protection (Minimal)

on:
  workflow_dispatch:
  push:
    branches: [ main ]

permissions:
  contents: read
  issues: write
  pull-requests: write

jobs:
  basic-scan:
    name: Basic IP Protection Scan
    runs-on: ubuntu-latest
    
    steps:
      - name: 🔐 Checkout
        uses: actions/checkout@v4
      
      - name: 🐍 Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
      
      - name: 📦 Install basic tools
        run: |
          pip install --upgrade pip
          pip install safety bandit
      
      - name: 🔍 Basic license scan
        run: |
          echo "📋 Checking for obvious license issues..."
          find . -name "*.py" -type f | head -10 | while read file; do
            if grep -l "GPL\|LGPL\|AGPL" "$file" 2>/dev/null; then
              echo "⚠️ Potential license issue in $file"
            fi
          done
          echo "✅ Basic license scan completed"
      
      - name: 🔒 Basic security scan
        run: |
          echo "🔍 Running security scan..."
          safety check --json > safety_report.json || echo "Safety check completed with warnings"
          bandit -r . -f json -o bandit_report.json || echo "Bandit scan completed"
          echo "✅ Security scan completed"
      
      - name: 📊 Generate basic report
        run: |
          echo "# 🛡️ Basic IP Protection Report" > IP_PROTECTION_REPORT.md
          echo "" >> IP_PROTECTION_REPORT.md
          echo "**Generated:** $(date)" >> IP_PROTECTION_REPORT.md
          echo "**Status:** Scan completed successfully" >> IP_PROTECTION_REPORT.md
          echo "" >> IP_PROTECTION_REPORT.md
          echo "## Files Scanned" >> IP_PROTECTION_REPORT.md
          echo "- Python files: $(find . -name '*.py' | wc -l)" >> IP_PROTECTION_REPORT.md
          echo "- Total files: $(find . -type f | wc -l)" >> IP_PROTECTION_REPORT.md
          echo "" >> IP_PROTECTION_REPORT.md
          echo "## Next Steps" >> IP_PROTECTION_REPORT.md
          echo "1. Review this report" >> IP_PROTECTION_REPORT.md
          echo "2. Install full IP protection toolkit" >> IP_PROTECTION_REPORT.md
          echo "3. Configure project-specific settings" >> IP_PROTECTION_REPORT.md
      
      - name: 📤 Upload report
        uses: actions/upload-artifact@v3
        with:
          name: ip-protection-report
          path: |
            IP_PROTECTION_REPORT.md
            safety_report.json
            bandit_report.json
          retention-days: 30
